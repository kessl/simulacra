<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>sim</title>
  </head>
  <body>
    <pre id="dump"></pre>
    <button id="tick">next tick</button>
    <script type="module">
      import init, { Universe } from './pkg/simulacra.js'
      async function run() {
        const module = await init()
        const universe = Universe.new()

        const button = document.getElementById('tick')
        button.addEventListener('click', function() {
          universe.tick()
        })

        const pre = document.getElementById('dump')
        function render() {
          const cells = new Uint32Array(module.memory.buffer, universe.cells_ptr(), universe.cells_count());
          pre.innerHTML = cells
          window.requestAnimationFrame(render)
        }
        render()
      }
      run()
    </script>
  </body>
</html>
